# BERRY IT: WinForge - Infinity Symbol, Less Spacing, Not Bold

Add-Type -AssemblyName PresentationFramework,PresentationCore

# Elevate to admin if needed
if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Start-Process powershell "-ExecutionPolicy Bypass -File `"$PSCommandPath`"" -Verb RunAs
    exit
}

# Logo path: use raw.githubusercontent for direct image access
$logoPath = "https://raw.githubusercontent.com/BERRY-2508/BERRY.IT.WEB/main/BERRY-IT.png"

# Application list
$apps = @(
    @{ Name = "7-Zip"; Id = "7zip.7zip" },
    @{ Name = "Google Chrome"; Id = "Google.Chrome" },
    @{ Name = "Mozilla Firefox"; Id = "Mozilla.Firefox" },
    @{ Name = "Microsoft Edge"; Id = "Microsoft.Edge" },
    @{ Name = "Brave Browser"; Id = "Brave.Brave" },
    @{ Name = "Notepad++"; Id = "Notepad++.Notepad++" },
    @{ Name = "Visual Studio Code"; Id = "Microsoft.VisualStudioCode" },
    @{ Name = "Git"; Id = "Git.Git" },
    @{ Name = "PowerShell 7"; Id = "Microsoft.PowerShell" },
    @{ Name = "Windows Terminal"; Id = "Microsoft.WindowsTerminal" },
    @{ Name = "VLC Media Player"; Id = "VideoLAN.VLC" },
    @{ Name = "Spotify"; Id = "Spotify.Spotify" },
    @{ Name = "Discord"; Id = "Discord.Discord" },
    @{ Name = "Steam"; Id = "Valve.Steam" },
    @{ Name = "OBS Studio"; Id = "OBSProject.OBSStudio" },
    @{ Name = "ShareX"; Id = "ShareX.ShareX" },
    @{ Name = "Rufus"; Id = "Rufus.Rufus" },
    @{ Name = "CPU-Z"; Id = "CPUID.CPU-Z" },
    @{ Name = "HWMonitor"; Id = "CPUID.HWMonitor" },
    @{ Name = "WinDirStat"; Id = "WinDirStat.WinDirStat" },
    @{ Name = "Paint.NET"; Id = "dotPDNLLC.paintdotnet" },
    @{ Name = "GIMP"; Id = "GIMP.GIMP" },
    @{ Name = "LibreOffice"; Id = "TheDocumentFoundation.LibreOffice" },
    @{ Name = "KeePass"; Id = "DominikReichl.KeePass" },
    @{ Name = "TeamViewer"; Id = "TeamViewer.TeamViewer" },
    @{ Name = "AnyDesk"; Id = "AnyDeskSoftwareGmbH.AnyDesk" },
    @{ Name = "Zoom"; Id = "Zoom.Zoom" },
    @{ Name = "qBittorrent"; Id = "qBittorrent.qBittorrent" },
    @{ Name = "Transmission"; Id = "Transmission.Transmission" },
    @{ Name = "FileZilla"; Id = "FileZilla.FileZilla" },
    @{ Name = "Python 3"; Id = "Python.Python.3" },
    @{ Name = "Node.js LTS"; Id = "OpenJS.NodeJS.LTS" },
    @{ Name = "Docker Desktop"; Id = "Docker.DockerDesktop" },
    @{ Name = "Putty"; Id = "PuTTY.PuTTY" },
    @{ Name = "Everything Search"; Id = "voidtools.Everything" },
    @{ Name = "VeraCrypt"; Id = "IDRIX.VeraCrypt" },
    @{ Name = "BleachBit"; Id = "BleachBit.BleachBit" }
)

# XAML UI definition
$xaml = @"
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="BERRY IT: WinForge"
        Height="800" Width="1220"
        Background="#1e1e1e"
        WindowStartupLocation="CenterScreen"
        FontFamily="Orbitron"
        Foreground="White">
    <Window.Resources>
        <!-- Colors and styles omitted for brevity -->
    </Window.Resources>
    <Grid>
        <!-- Header -->
        <StackPanel Orientation="Horizontal" Background="#212121" Height="64" VerticalAlignment="Top">
            <Image x:Name="logo" Width="48" Height="48" Margin="16,8,0,8"/>
            <TextBlock Text="BERRY IT: WinForge" FontSize="32" FontWeight="Bold" Foreground="#F50019" VerticalAlignment="Center" Margin="16,0,0,0"/>
        </StackPanel>
        <!-- Main content omitted for brevity -->
        <!-- ABOUT Tab -->
        <TabItem Header="About">
            <Grid>
                <StackPanel Margin="28,16,28,72">
                    <TextBlock Text="About BERRY IT: WinForge" FontSize="24" FontWeight="Bold" Foreground="#F50019" Margin="0,0,0,16"/>
                    <TextBlock
                        Text="BERRY IT: WinForge is your one-stop system utility and software installer for Windows, powered by BERRY IT."
                        FontSize="17" TextWrapping="Wrap" Margin="0,0,0,16" Foreground="White"/>
                    <TextBlock x:Name="websiteTextBlock" Text="Website: https://berryit.com.au" FontSize="16" Foreground="#F50019" Cursor="Hand"/>
                </StackPanel>
                <!-- Version label -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,8,8">
                    <TextBlock Text="Version" FontSize="13" FontWeight="Bold" Foreground="#CCCCCC" VerticalAlignment="Center"/>
                    <TextBlock Text="âˆž" FontSize="24" FontWeight="Normal" Foreground="#CCCCCC" Margin="0" VerticalAlignment="Center"/>
                    <TextBlock Text="Forked from the best, Broken by me" FontSize="13" FontWeight="Bold" Foreground="#CCCCCC" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </TabItem>
    </Grid>
</Window>
"@

# Load XAML
$reader = (New-Object System.Xml.XmlNodeReader ([xml]$xaml))
$window = [Windows.Markup.XamlReader]::Load($reader)

# Logo load
if ($logoPath -and $window.FindName("logo")) {
    $window.FindName("logo").Source = [Windows.Media.Imaging.BitmapImage]::new([Uri]$logoPath)
}

# System info logic omitted for brevity...

# Rest of script unchanged
$window.ShowDialog() | Out-Null
